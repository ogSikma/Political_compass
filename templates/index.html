<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kompas Polityczny</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        function positionBubbles() {
            const container = document.querySelector('.bubble-container');
            const bubbles = document.querySelectorAll('.category-bubble');

            const centerX = container.clientWidth / 2; // Åšrodek kontenera
            const centerY = container.clientHeight / 2;
            const radius = Math.min(container.clientWidth, container.clientHeight) / 2+ 20; // Dopasowany promieÅ„

            //const rect = container.getBoundingClientRect();
            //const radius = Math.min(rect.width, rect.height) / 2;

            const angleStep = (2 * Math.PI) / bubbles.length;

            bubbles.forEach((bubble, index) => {
                const angle = angleStep * index;
                const x = centerX + radius * Math.cos(angle) - bubble.clientWidth / 2; // UwzglÄ™dniamy wielkoÅ›Ä‡ bÄ…belka
                const y = centerY + radius * Math.sin(angle) - bubble.clientHeight / 2;
                
                bubble.style.position = 'absolute';
                bubble.style.left = `${x}px`;
                bubble.style.top = `${y}px`;
            });
        }

        const categoryDescriptions = {
              'aborcja': "Co sÄ…dzisz o <br><b>legalizacji aborcji</b>?<br><br><p class='opis'>Powinna byÄ‡ dozwolona?<br>MoÅ¼e pod jakimÅ› wyjÄ…tkiem?<br>Jest to sprawa kobiety, czy nie tylko?</p>",
              'armia_ue': "Co sÄ…dzisz o <br><b>wspÃ³lnej armii Unii Europejskiej</b>?<br><br><p class='opis'>Czy byloby to dobre dla Polski?<br>Jest zagroÅ¼eniem suwerennoÅ›ci?<br>A moÅ¼e gwarancjÄ… bezpieczeÅ„stwa?</p>",
              'bron': "Co sÄ…dzisz o <br><b>ulatwieniu posiadania broni przez obywateli</b>?<br><br><p class='opis'>Czy aktualne przepisy sÄ… wystarczajÄ…ce?<br>A moÅ¼e regulacje powinny byÄ‡ wiÄ™ksze?<br>Czy jednak dostÄ™p powinien byÄ‡ prostszy?</p>",
              'cpk': "Co sÄ…dzisz o <br><b>projekcie CPK</b>?<br><br><p class='opis'>Szansa dla Polski czy stracone pieniÄ…dze?<br>Za duÅ¼o niepewnoÅ›ci? Braku kompetencji?<br>Czy moÅ¼e idealny moment i potrzebna inwestycja?</p>",
              'dochodowy': "Co sÄ…dzisz o <br><b>podatku dochodowym</b>?<br><br><p class='opis'>KradzieÅ¼ ciÄ™Å¼ko zarobionych pieniÄ™dzy?<br>Czy sprawiedliwe ÅºrÃ³dlo dochodu skarbu paÅ„stwa?</p>",
              'euro': "Co sÄ…dzisz o <br><b>wprowadzeniu waluty Euro</b>?<br><br><p class='opis'>WaÅ¼ny temat do podjÄ™cia dyskusji?<br>Bezpieczna i stabilna waluta?<br>Czy utrata niezaleÅ¼noÅ›ci i wyÅ¼sze ceny?</p>",
              'eutanazja': "Co sÄ…dzisz o <br><b>legalizacji eutanazji</b>?<br><br><p class='opis'>Potrzebna inicjatywa w Å›lad za Zachodem?<br>Niemoralne podejÅ›cie i pole do naduÅ¼yÄ‡?<br>Czy moÅ¼e danie wyboru godnego odejÅ›cia?</p>",
              'imigranci': "Co sÄ…dzisz o<br> <b>imigrantach z bialoruskiej granicy</b>?<br><br><p class='opis'>PowinniÅ›my ich wpuÅ›ciÄ‡?<br>DuÅ¼e ryzyko i zagroÅ¼enie?<br>Czy waÅ¼niejsza jest empatia i prawa czlowieka?<br>A moÅ¼e to wszystko to wojna hybrydowa i siÄ™ odgradzaÄ‡?</p>",
              'invitro': "Co sÄ…dzisz o <br><b>in-vitro</b>?<br><br><p class='opis'>Dobre rozwiÄ…zanie pomocne dla niektÃ³rych par?<br>Czy jednak niemoralne podejÅ›cie wbrew naturze?<br>Powinno siÄ™ refundowaÄ‡ albo finansowaÄ‡?</p>",
              'kara_smierci': "Co sÄ…dzisz o <br><b>karze Å›mierci</b>?<br><br><p class='opis'>Polska powinna do niej wrÃ³ciÄ‡?<br>PrzeÅ¼ytek niezgodny z cywilizacjÄ… XXI wieku?<br>Czy moÅ¼e sluszne rozwiÄ…zanie?<br>A moÅ¼e tylko za pewne przestÄ™pstwa?</p>",
              'katastralny': "Co sÄ…dzisz o <br><b>podatku katastralnym</b>?<br><br><p class='opis'>Polska powinna go wprowadziÄ‡?<br>Potrzebny cios w bogate osoby, flipperÃ³w i developerÃ³w?<br>Czy obawa uderzenia w zwyklych obywateli?</p>",
              'osiemset': "Co sÄ…dzisz o <br><b>Å›wiadczeniu 800+</b>?<br><br><p class='opis'>Potrzebne Å›wiadczenie ratujÄ…ce demografiÄ™?<br>Strata pieniÄ™dzy nieprzynoszÄ…ca rezultatÃ³w?<br>Czy jednak duÅ¼e ukojenie dla biedniejszych rodzin?</p>",
              'samochody': "Co sÄ…dzisz o <br><b>zakazie samochodÃ³w przez UE</b>?<br><br><p class='opis'>Dobry pomysl ratujÄ…cy planetÄ™?<br>Czy ograniczanie wolnoÅ›ci jednostki i cios w biednych<br>PowinniÅ›my to odrzuciÄ‡ czy realizowaÄ‡ program Unii Europejskiej?</p>",
              'sluzba_wojskowa': "Co sÄ…dzisz o <br><b>obowiÄ…zkowej sluÅ¼bie wojskowej</b>?<br><br><p class='opis'><br><br></p>",
              'ue': "Jaki kierunek powinna obraÄ‡ Polska wzglÄ™dem <br><b>Unii Europejskiej</b>?<br><br><p class='opis'><br><br></p>",
              'wdowia': "Co sÄ…dzisz o <br><b>rencie wdowiej</b>?<br><br><p class='opis'><br><br></p>",
              'zus': "Co sÄ…dzisz o <br><b>ZUSie i prywatyzacji Å›wiadczeÅ„ socjalnych i emerytalnych</b>?<br><br><p class='opis'><br><br></p>"
        };

        function selectCategory(category, element) {
            document.getElementById('category-input').value = category;
            document.querySelectorAll('.category-bubble').forEach(bubble => bubble.style.border = 'none');
            event.target.style.border = '2px solid white';
            //element.style.border = '2px solid white';

            const description = categoryDescriptions[category] || "Brak opisu dla tej kategorii.";
            document.getElementById('category-description').innerHTML = description;
        }

        window.onload = function() { positionBubbles(); };
    </script>
</head>
<body>
    <div class="left-space">
        <p>
            3 zasady aby uzyskaÄ‡ dobre wyniki: </br></br>
            1. Postaraj siÄ™ odpowiedzieÄ‡ w formie: </br> "<b>PoglÄ…d</b>, poniewaÅ¼ <b>argumentacja"</b></br></br>
            2. SprÃ³buj zmieÅ›ciÄ‡ siÄ™ w 1-2 zdaniach</br></br>
            3. Nie bÄ…dÅº zÅ‚oÅ›liwy dla kompasu
        </p>
        <img src="static/images/logo.png" class="logo-img" alt="logo">
    </div>

    <div class="bubble-container">
        <div class="center-space" id="center-space">
            <p id="category-description">Wybierz spoÅ›rÃ³d siedemnastu tematÃ³w i powiedz o swoich poglÄ…dach</p>
            <button id="show-button" class="show-button" 
            {% if show_button %}
                style="display: block;"
            {% else %}
                style="display: none;"
            {% endif %} 
            onclick="window.location.href='/wyniki'">PokaÅ¼ wyniki</button>        
        </div>        
        {% for cat in categories %}
        <div class="category-bubble" onclick="selectCategory('{{ cat }}')" data-category="{{ cat }}">
            <img src="{{ url_for('static', filename='images/' + cat.split(':')[0]|replace(' ', '_')|replace('/', '_')|replace('\\', '_') + '.png') }}" class="bubble-img" 
                                alt="{{ cat.split(':')[0] }}">
        </div>
        {% endfor %}
    </div>

    <div class="bottom-space">
        <form method="POST" action="/kompas">
            <button type="button" class="mic_button">Powiedz ğŸ¤</button>
            <input type="hidden" id="category-input" name="category">
            <input type="text" id="opinion-input" name="opinion" placeholder="Co o tym uwaÅ¼asz?" required>
            <button type="submit" class="send_button">WyÅ›lij</button>
        </form>
    </div>
<script>
document.querySelector('.mic_button').addEventListener('click', (event) => {
    event.preventDefault();  // zatrzymaj wysÅ‚anie formularza

    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (!SpeechRecognition) {
        alert('Twoja przeglÄ…darka nie wspiera rozpoznawania mowy');
        return;
    }

    console.log('Startujemy rozpoznawanie mowy...');
    const recognition = new SpeechRecognition();
    recognition.lang = 'pl-PL'; // jÄ™zyk polski
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.start();

    recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        console.log('Rozpoznano:', transcript);
        document.getElementById('opinion-input').value = document.getElementById('opinion-input').value + transcript;
        // odkomentuj, jeÅ›li chcesz automatycznie wysÅ‚aÄ‡ formularz
        // document.getElementById('opinion-form').submit();
    };

    recognition.onerror = (event) => {
        alert('BÅ‚Ä…d rozpoznawania mowy: ' + event.error);
        console.error('BÅ‚Ä…d rozpoznawania:', event.error);
    };

    recognition.onspeechend = () => {
        console.log('Rozpoznawanie zakoÅ„czone.');
        recognition.stop();
    };
});
</script>

</body>
<script>
    positionBubbles();
</script>
</html>